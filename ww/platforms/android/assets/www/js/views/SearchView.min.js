define(["text!templates/ww/search-tpl.html"],function(e){var i=function(){this.initialize=function(){this.$el=$("<div/>");this.$el.html($wwCompile(e)(getScope()));setScope("wwSearchObj",{wwSearchText:""});this.hash=window.location.hash.substr(1)};this._done=function(e){var i=this;if(!e){e=[]}setScope("wwSearchItems",e,false);if(!getScope("wwSearchItems")||getScope("wwSearchItems").length==0){i.$el.find(".no-wws").show()}else{i.$el.find(".no-wws").hide()}};this.render=function(){return this};this.setFocus=function(){this.$el.find(".ww-search input").focus()};this.bindEvents=function(){var e=this;$(e.$el).off("click.li").on("click.li","li.table-view-cell",function(){window.location.href="#ww/detail/"+$(this).attr("data-id")});var i;var t,n;$(e.$el).off("keyup.search").on("keyup.search",".ww-search input",function(){clearTimeout(i);i=setTimeout(function(){t=getScope("wwSearchObj").wwSearchText;if(t){t=t.trim()}if(t!==n){n=t;e.$el.find(".icon-search").addClass("loading");window.wwService.textSearch(t).done(function(i){e._done(i,false,true);e.$el.find(".icon-search").removeClass("loading")})}},600)});$(e.$el).off("click.clear").on("click.clear",".ww-search .icon-close",function(){setScope("wwSearchObj",$.extend(getScope("wwSearchObj"),{wwSearchText:""}));$(this).parent().find("input").trigger("keyup")});return e};this.initialize()};return i});