define(["text!templates/login-tpl.html"],function(i){var n=function(n){this.initialize=function(){this.$el=$("<div/>");this.$el.html($wwCompile(i)(getScope()))};this.render=function(){var i=this.$el.find("#login");var n=$('<div class="user-list" style="display:none;position: absolute;top:280px;left:6px;border:1px solid #ddd;border-radius:5px;padding:5px;">'+'<h5 style="margin:5px 0 10px;text-align:center;">选择登录用户（仅供测试）</h5>'+'<ul style="list-style:none;padding:0;margin:0;width:250px;background-color:#eee;border-radius:4px;max-height:222px;overflow:auto;"></ul>'+"<style>.user-list ul li{padding:8px;}.user-list ul li:nth-child(even){background-color:#f8f8f8;}</style>"+"</div>").appendTo(i);window.loginService.getTestingUsers().done(function(e){var t=n.find("ul");$.each(e,function(n,e){var o=$('<li data-user-id="'+e.userId+'">'+e.userId+": "+e.nickName+"</li>").click(function(){i.find('input[name="user"]').val(e.userId);alert("已选："+e.userId+" - "+e.nickName)});t.append(o)})});var e=$.wwFloatingButton({target:i,btnName:"ww-login-floating-btn",allowDrag:false,icon:"icon-more",onClick:function(){if(e.hasClass("icon-more")){n.show();e.switchIcon("icon-cross")}else{n.hide();e.switchIcon()}}}).css("top","400px");return this};this.bindEvents=function(){var i=this.$el;i.find("#btn-login").off("click").click(function(){window.loginService.login(i.find('input[name="user"]').val(),i.find('input[name="password"]').val()).done(function(i){window.user=i;n.switchView("main")}).fail(function(n){i.find("#login-message").text(n.responseText).show()})});i.find("#link-reset-password").click(function(){alert("TODO")});i.find("#btn-sign-up").click(function(){alert("TODO")});i.find("#link-browse").click(function(){n.switchView("main")});return this};this.initialize()};return n});