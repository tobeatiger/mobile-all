define(["text!templates/ww/ww-creation-tags.html"],function(t){var i=function(i){this.initialize=function(){this.$el=$("<div/>");this.$el.html($wwCompile(t)(getScope()))};this.render=function(){return this};this.bindEvents=function(){var t=this.$el;t.find("a.icon-left-nav").off("click").click(function(){window.backHandler()});t.find("a.ww-save").off("click").click(function(){if(t.find("li .toggle.active").length==0){alert("最少选择一个标签",{top:"440px"})}else{var e=setScope(i,$.extend(getScope(i),function(t){var i=[];t.each(function(){i.push({name:$(this).parent().text().trim()})});return{wwTags:i}}(t.find("li .toggle.active"))));wwService.createOrUpdate(i,e).done(function(t){history.pushState({},"","#ww");window.location.href="#ww/detail/"+t._id;setTimeout(function(){setScope(i,{});alert(i==window.wwActions.newWW?"创建成功":"修改成功")},400)}).fail(function(){alert(i==window.wwActions.newWW?"哎呀，创建出了点问题":"哎呀，修改出了点问题")})}});t.find("li .toggle").off("click").click(function(){if($(this).hasClass("active")){$(this).removeClass("active")}else{if(t.find("#ww-tags-common > li .toggle.active").length>=2&&$(this).closest("ul").attr("id")!=="ww-tag-question"){alert("最多选择两个标签",{top:"440px"})}else{$(this).addClass("active")}}});return this};this.initWWTags=function(){var t=$.map(getScope("currentWW").wwTags,function(t){return t.name});this.$el.find("#ww-tags-common li .toggle").each(function(){if($.inArray($(this).parent().text().trim(),t)>-1){$(this).addClass("active")}else{$(this).removeClass("active")}})};this.initialize()};return i});