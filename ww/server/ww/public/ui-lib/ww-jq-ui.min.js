(function(e){e.wwBubbleNotification=function(t){var n=e.extend(true,{text:"Some information...",position:{bottom:"70px"},delay:2e3},t?t:{});var i=e('<div class="ww-bubble-notification"></div>').text(n.text).appendTo(e("body"));if(n.position.top){i.css("top",n.position.top)}else{i.css("bottom",n.position.bottom)}i.css("margin-left","calc(50% - "+(i.width()+30)/2+"px)").delay(n.delay).fadeOut(300,function(){i.remove()});return i}})(jQuery);(function(e){e.wwConfirmOption=function(t){var n=e.extend(true,{target:e("body"),onConfirm:function(e){console.log(e)}},t?t:{});var i=n.target.find("#ww-confirm");if(!i.get(0)){i=e('<div id="ww-conform">'+'<div class="ww-background-cover">'+"</div>"+'<div style="position:absolute;top:0;left:0;background-color:white;border-radius:4px;text-align:center;height:132px;width:80%;z-index:2;margin-top:50%;margin-left:10%;padding:30px">'+'<div style="display:inline-block;height:100%;width:calc(50% - 15px);margin-right:15px;"><span data-index="1" class="icon icon-camera" style="font-size:72px"></span></div>'+'<div style="display:inline-block;height:100%;width:calc(50% - 15px);margin-left:15px;"><span data-index="2" class="icon icon-image" style="font-size:72px;position:relative;top:2px;"></span></div>'+"</div>"+"</div>").appendTo(n.target)}i.find("span").click(function(){n.onConfirm(e(this).attr("data-index"));i.hide()}).end().find("> div:nth(0)").click(function(){i.hide()});return i.show()}})(jQuery);(function(e){e.wwFloatingButton=function(t){var n=e.extend(true,{target:e("body"),btnName:"",icon:"icon-more",top:300,onClick:function(){console.log("default click")}},t?t:{});var i=n.target.find(".ww-draggable-btn");n.maxTop=n.maxTop||n.target.height()-80;var o=function(e){e.stopPropagation();var t=window.getComputedStyle(e.target,null);o.data=parseInt(t.getPropertyValue("left"),10)-e.clientX+","+(parseInt(t.getPropertyValue("top"),10)-e.clientY);o._top=i[0].style.top};var a=function(e){e.preventDefault();e.stopPropagation();if(!o.data){return false}var t=o.data.split(",");var a=e.clientY+parseInt(t[1],10);i[0].style.top=(a<30?30:a>n.maxTop?n.maxTop:a)+"px"};var r=function(t){t.stopPropagation();o.data=undefined;localStorage.setItem(n.btnName,i[0].style.top);if(o._top===i[0].style.top&&e(t.target).hasClass("ww-draggable-btn")&&!r._clickFired){r._clickFired=true;n.onClick.bind(i)();setTimeout(function(){r._clickFired=false},50)}};if(!i.get(0)){i=e('<aside class="ww-draggable-btn icon" draggable="true"></aside>').prependTo(n.target);i[0].addEventListener("mousedown",o,false);n.target[0].addEventListener("mousemove",a,false);n.target[0].addEventListener("mouseup",r,false)}i.css("top",localStorage.getItem(n.btnName)||n.top+"px").addClass(n.icon);i.switchIcon=function(e){if(e){i.removeClass(n._currentIcon).removeClass(n.icon).addClass(e);n._currentIcon=e}else{i.removeClass(n._currentIcon).addClass(n.icon)}};return i}})(jQuery);(function(e){e.fn.wwFloatingList=function(t){var n=e(this);var i=e.extend(true,{items:[{icon:"icon-gear",text:"标签",onClick:function(e){console.log("item "+e.text+" clicked")}}]},t?t:{});var o=e('<div class="ww-floating-list">'+'<div class="ww-background-cover"></div>'+"<ul></ul>"+"</div>");n.before(o);var a=o.find("ul");a.css("right",parseInt(n.css("right"))+70+"px");function r(t){e('<li><span class="icon '+t.icon+'"></span><span class="item">'+t.text+"</span></li>").click(function(){t.onClick(t)}).appendTo(a)}for(var l=0;l<i.items.length;l++){var s=i.items[l];r(s)}o.hide();o.toggleList=function(){o.fadeToggle(100);var e=parseInt(n.css("top"))-parseInt(a.css("height"))+parseInt(n.css("height"));if(e<30){e=30}a.css("top",e+"px")};o.find(".ww-background-cover").click(function(){if(i.hideList&&typeof i.hideList=="function"){i.hideList();o.fadeOut(100)}});return o}})(jQuery);(function(e){var t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"};for(originalType in t){document.addEventListener(originalType,function(e){var n=document.createEvent("MouseEvents");var i=e.changedTouches[0];n.initMouseEvent(t[e.type],true,true,window,0,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null);e.target.dispatchEvent(n)})}})(jQuery);(function(e){e.fn.wwPopupMenu=function(t){var n=e(this);var i=e.extend(true,{items:[{icon:"icon-sort-asc",text:"时间升序",onClick:function(e){console.log("item "+e.text+" clicked")}}],position:{top:50,right:14}},t?t:{});var o=e('<div class="ww-popup-menu">'+'<div class="ww-background-cover"></div>'+"<ul></ul>"+"</div>");n.before(o);var a=o.find("ul");a.css("right",parseInt(n.css("right"))+70+"px");var r=i.items[0];function l(t){var n=e('<li><span class="icon '+t.icon+'"></span><span class="item icon">'+t.text+"</span></li>").click(function(){e(this).parent().find("li").removeClass("selected");e(this).addClass("selected");t.onClick(t);o.toggleList();r=t}).appendTo(a);if(t.selected){n.addClass("selected")}}for(var s=0;s<i.items.length;s++){var c=i.items[s];l(c)}o.hide();o.toggleList=function(){o.fadeToggle(100);a.css("top",i.position.top+"px").css("right",i.position.right+"px")};o.getSelectedItem=function(){return r};o.find(".ww-background-cover").click(function(){if(i.hideList&&typeof i.hideList=="function"){i.hideList();o.fadeOut(100)}});return o}})(jQuery);(function(e){e.fn.wwPullEvent=function(t){var n=e(this);var i=e.extend(true,{pull:function(e){},pullEnd:function(){}},t?t:{});var o=function(e){e.stopPropagation();if(n.scrollTop()<3){o.startTop=e.clientY}else{o.startTop=undefined}};var a=function(e){e.preventDefault();e.stopPropagation();if(o.startTop==undefined||e.clientY-o.startTop<1){return false}i.pull.apply(n,[e.clientY-o.startTop])};var r=function(e){e.stopPropagation();o.startTop=undefined;i.pullEnd.apply(n,[])};n.off("mousedown").on("mousedown",o).off("mousemove").on("mousemove",a).off("mouseup").on("mouseup",r);return n}})(jQuery);(function(e){var t=Quill.import("delta");e.addQHandler=function(n,i){if(n=="image"){if(navigator.camera&&navigator.camera){i.addHandler("image",function(){var n=this.quill;var i=n.getSelection().index;e.wwConfirmOption({target:e("body").find("> div.page"),onConfirm:function(e){var o={quality:50,allowEdit:true,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.SAVEDPHOTOALBUM,encodingType:Camera.EncodingType.JPEG};if(e==1){o.sourceType=Camera.PictureSourceType.CAMERA}navigator.camera.getPicture(function e(o){n.updateContents((new t).retain(i).insert({image:"data:image/jpg;base64,"+o},{alt:"(图片)"}))},function e(t){console.debug("Unable to obtain picture: "+t,"app")},o)}});n.blur()})}else{}}if(n=="link"){i.addHandler("link",function(e){var n=this.quill;if(e){var i=prompt("请输入链接地址");var o=prompt("请输入链接名称");if(i&&i.trim()!=""){if(!o||o.trim()==""){o=i}n.updateContents((new t).retain(n.getSelection().index).insert(o,{link:i}))}}})}if(n=="bold"){i.addHandler("bold",function(e){var n=this.quill;var i=n.getSelection().index;var o=n.getSelection().length;var a=n.getContents(i,o);var r=null;a.forEach(function(e){if(!e.attributes){e.attributes={}}if(r===null){r=!e.attributes.bold}e.attributes.bold=r});n.updateContents((new t).retain(i).delete(o).concat(a));n.setSelection(i,o)})}}})(jQuery);(function(e){e.fn.wwScrollLoader=function(t){var n=e(this);var i=e.extend(true,{bottomPixels:30,loader:e('<div class="ww-scroll-loader">正在努力加载...</div>'),insertAfter:function(){return n.find("li:last")},loadBottom:function(){return true},pull:function(e){},pullEnd:function(){},onScroll:null},t?t:{});var o=false;var a=0;n.endOfList=false;n.off("scroll").on("scroll",function(){if(i.onScroll&&typeof i.onScroll=="function"){i.onScroll(n.scrollTop());if(!i.loadBottom){return}}if(n.endOfList){return}var e=n.find(".ww-scroll-loader-inner-wrap");if(e.length==0){e=n.wrapInner('<div class="ww-scroll-loader-inner-wrap" />').find(".ww-scroll-loader-inner-wrap")}var t=e.length>0&&e.height()-n.height()<=n.scrollTop()+i.bottomPixels;if(t&&!o){if(!n.find("#ww-scroll-loader").get(0)){n.appendLoader()}else{a++;o=true;i.loadBottom.apply(n,[a]);var r=function(e){var t=setInterval(function(){if(!n.find("#ww-scroll-loader").get(0)){clearInterval(t);o=false}else if((new Date).getTime()-e>2e4){clearInterval(t);o=false}},500)}((new Date).getTime())}}});if(i.pull&&i.pullEnd){n.wwPullEvent({pull:i.pull,pullEnd:i.pullEnd})}n.resetCounter=function(){a=0};n.removeLoader=function(){n.find("#ww-scroll-loader").remove();return n};n.appendLoader=function(){i.insertAfter().after('<div id="ww-scroll-loader"></div>');return n.find("#ww-scroll-loader").append(i.loader)};n.endOfScroll=function(){n.endOfList=true;n.removeLoader().appendLoader().find(".ww-scroll-loader").text("没有更多内容")};n.resetLoaderPosition=function(){i.insertAfter().after(n.find("#ww-scroll-loader").detach())};n.rememberScroll=function(){n.data("scroll-top",n.scrollTop())};n.resetScroll=function(){setTimeout(function(){n.scrollTop(parseInt(n.data("scroll-top")))},1)};return n}})(jQuery);(function(e){e.fn.wwViewLoader=function(t,n){var i=e(this);var o=e.extend(true,{top:100},n?n:{});if(!t&&!i.find(".ww-view-loader").get(0)){i.prepend('<div class="ww-view-loader"></div>').find(".ww-view-loader").css("top",o.top+"px")}else if(!t&&i.find(".ww-view-loader").get(0)){i.find(".ww-view-loader").css("top",o.top+"px")}else if((t=="R"||t=="Remove")&&i.find(".ww-view-loader").get(0)){i.find(".ww-view-loader").fadeOut(function(){e(this).remove()})}else if((t=="H"||t=="Hide")&&i.find(".ww-view-loader").get(0)){i.find(".ww-view-loader").css("top","-80px").one("webkitTransitionEnd",function(t){e(t.target).remove()})}return i.find(".ww-view-loader")}})(jQuery);